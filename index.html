
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Simple Car Race Game</title>
<style>
  body {
    background: #222;
    margin: 0;
    overflow: hidden;
  }
  #gameCanvas {
    background: #555;
    display: block;
    margin: 20px auto;
    border: 5px solid #fff;
    border-radius: 10px;
    background-image: linear-gradient(to bottom, #333 0%, #555 100%);
  }
</style>
</head>
<body>

<canvas id="gameCanvas" width="400" height="600"></canvas>

<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');

  const roadWidth = 200;
  const roadLeft = (canvas.width - roadWidth) / 2;
  const roadRight = roadLeft + roadWidth;

  const laneCount = 3;
  const laneWidth = roadWidth / laneCount;

  // Player car
  const car = {
    width: 40,
    height: 80,
    x: roadLeft + laneWidth, // start in middle lane
    y: canvas.height - 100,
    speed: 5,
    lane: 1
  };

  // Obstacles
  let obstacles = [];

  // Controls
  let leftPressed = false;
  let rightPressed = false;

  let gameOver = false;
  let score = 0;

  function drawRoad() {
    // road background
    ctx.fillStyle = '#444';
    ctx.fillRect(roadLeft, 0, roadWidth, canvas.height);

    // lane lines
    ctx.strokeStyle = '#fff';
    ctx.lineWidth = 3;
    ctx.setLineDash([20, 20]);

    for (let i = 1; i < laneCount; i++) {
      let x = roadLeft + laneWidth * i;
      ctx.beginPath();
      ctx.moveTo(x, 0);
      ctx.lineTo(x, canvas.height);
      ctx.stroke();
    }

    ctx.setLineDash([]);
  }

  function drawCar() {
    ctx.fillStyle = 'red';
    ctx.fillRect(car.x, car.y, car.width, car.height);

    // wheels
    ctx.fillStyle = 'black';
    ctx.fillRect(car.x + 5, car.y + 10, 10, 20);
    ctx.fillRect(car.x + car.width - 15, car.y + 10, 10, 20);
    ctx.fillRect(car.x + 5, car.y + car.height - 30, 10, 20);
    ctx.fillRect(car.x + car.width - 15, car.y + car.height - 30, 10, 20);
  }

  function drawObstacles() {
    ctx.fillStyle = 'yellow';
    obstacles.forEach(ob => {
      ctx.fillRect(ob.x, ob.y, ob.width, ob.height);
    });
  }

  function moveCar() {
    if (leftPressed && car.lane > 0) {
      car.lane--;
      car.x = roadLeft + car.lane * laneWidth + (laneWidth - car.width) / 2;
      leftPressed = false;
    }
    if (rightPressed && car.lane < laneCount - 1) {
      car.lane++;
      car.x = roadLeft + car.lane * laneWidth + (laneWidth - car.width) / 2;
      rightPressed = false;
    }
  }

  function moveObstacles() {
    obstacles.forEach(ob => {
      ob.y += 5;
    });
    // remove obstacles that are out of canvas
    obstacles = obstacles.filter(ob => ob.y < canvas.height);
  }

  function addObstacle() {
    // create obstacle in random lane
    const lane = Math.floor(Math.random() * laneCount);
    const x = roadLeft + lane * laneWidth + (laneWidth - 40) / 2;
    obstacles.push({ x: x, y: -80, width: 40, height: 80 });
  }

  function detectCollision() {
    for (let ob of obstacles) {
      if (
        car.x < ob.x + ob.width &&
        car.x + car.width > ob.x &&
        car.y < ob.y + ob.height &&
        car.y + car.height > ob.y
      ) {
        gameOver = true;
      }
    }
  }

  function drawScore() {
    ctx.fillStyle = 'white';
    ctx.font = '20px Arial';
    ctx.fillText(`Score: ${score}`, 10, 30);
  }

  function gameLoop() {
    if (gameOver) {
      ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = 'red';
      ctx.font = '40px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('Game Over!', canvas.width / 2, canvas.height / 2);
      ctx.font = '20px Arial';
      ctx.fillText(`Final Score: ${score}`, canvas.width / 2, canvas.height / 2 + 40);
      return;
    }

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    drawRoad();
    drawCar();
    drawObstacles();
    drawScore();

    moveCar();
    moveObstacles();
    detectCollision();

    if (Math.random() < 0.02) {
      addObstacle();
    }

    score++;
    requestAnimationFrame(gameLoop);
  }

  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') leftPressed = true;
    if (e.key === 'ArrowRight') rightPressed = true;
  });

  // Start positions
  car.x = roadLeft + car.lane * laneWidth + (laneWidth - car.width) / 2;

  gameLoop();
</script>

</body>
</html>
